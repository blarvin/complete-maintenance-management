import{c as C,i as d,_ as s,a as p,b as h,S as J,d as y,e as u,u as _,f as c,g as x,h as U,j as W,k as E,l as K,m as he,n as me,o as A,p as j,q as F}from"./q-C_WZLTFx.js";import"firebase/firestore";const we="_nodeWrapper_1qvcl_4",Ne="_node_1qvcl_4",$e="_nodeExpanded_1qvcl_18",be="_nodeBody_1qvcl_20",Ce="_nodeParent_1qvcl_29",Ie="_upButtonWrapper_1qvcl_35",Se="_nodeBodyClickable_1qvcl_44",De="_nodeTitle_1qvcl_48",Ve="_nodeSubtitle_1qvcl_63",Ee="_nodeChevron_1qvcl_83",Re="_constructionActions_1qvcl_119",w={nodeWrapper:we,node:Ne,nodeExpanded:$e,nodeBody:be,nodeParent:Ce,upButtonWrapper:Ie,nodeBodyClickable:Se,nodeTitle:De,nodeSubtitle:Ve,nodeChevron:Ee,constructionActions:Re},Fe=e=>s("h2",null,{class:w.nodeTitle,id:p(t=>t.id,[e],"p0.id")},p(t=>t.nodeName,[e],"p0.nodeName"),3,"Th_0"),Oe=C(d(Fe,"s_DVVkpy7hRQQ")),ke=e=>s("div",null,{class:w.nodeSubtitle},p(t=>t.nodeSubtitle,[e],"p0.nodeSubtitle"),3,"ld_0"),Ae=C(d(ke,"s_BPVk0Y80MRc")),Be="_wrapper_10kg1_7",Te="_wrapperOpen_10kg1_47",Pe="_inner_10kg1_57",xe="_datacard_10kg1_71",Ue="_datacardOpen_10kg1_103",L={wrapper:Be,wrapperOpen:Te,inner:Pe,datacard:xe,datacardOpen:Ue},We=e=>s("div",{class:[L.wrapper,e.isOpen&&L.wrapperOpen]},null,s("div",null,{class:L.inner},s("div",{class:[L.datacard,e.isOpen&&L.datacardOpen,"no-caret"]},{role:"region","aria-label":"Node details"},[h(J,null,3,"9y_0"),h(J,{name:"actions",[y]:{name:y}},3,"9y_1")],1,null),1,null),1,"9y_2"),ae=C(d(We,"s_L7oO92ZEh6A"));function z(){try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID()}catch{}return`id_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,8)}`}const Me="localUser",qe=["Description","Type Of","Tags","Location","Serial Number","Part Number","Manufacturer","Model","Status","Installed Date","Weight","Dimensions","Power Rating","Current Reading","Note"],Le=["Type Of","Description","Tags"];function G(){return Me}const M=()=>Date.now(),Ge=e=>new Date(e).toLocaleString(void 0,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit"});function ee(e,t,n){const a=new Error(t);return a.code=e,a.retryable=(n==null?void 0:n.retryable)??e==="unavailable",a.details=n==null?void 0:n.details,a.cause=n==null?void 0:n.cause,a}function S(e,t=!0){return{data:e,meta:{adapter:"idb",fromCache:t}}}class Qe{async listRootNodes(){const n=(await u.nodes.toArray()).filter(a=>a.parentId===null);return n.sort((a,o)=>o.updatedAt-a.updatedAt),S(n)}async getNode(t){const n=await u.nodes.get(t);return S(n??null)}async listChildren(t){const n=await u.nodes.where("parentId").equals(t).toArray();return n.sort((a,o)=>o.updatedAt-a.updatedAt),S(n)}async createNode(t){const n=M(),a=G(),o={id:t.id,nodeName:t.nodeName,nodeSubtitle:t.nodeSubtitle,parentId:t.parentId,updatedBy:a,updatedAt:n};return await u.transaction("rw",u.nodes,u.syncQueue,async()=>{await u.nodes.put(o),await this.enqueueSyncOperation({operation:"create-node",entityType:"node",entityId:o.id,payload:o})}),S(o)}async updateNode(t,n){const a=M(),o=G();return await u.transaction("rw",u.nodes,u.syncQueue,async()=>{await u.nodes.update(t,{...n,updatedBy:o,updatedAt:a});const l=await u.nodes.get(t);l&&await this.enqueueSyncOperation({operation:"update-node",entityType:"node",entityId:t,payload:l})}),S(void 0)}async deleteNode(t,n){if(await u.nodes.where("parentId").equals(t).count()>0)throw ee("validation","Only leaf nodes can be deleted",{retryable:!1});return await u.transaction("rw",u.nodes,u.syncQueue,async()=>{await u.nodes.delete(t),await this.enqueueSyncOperation({operation:"delete-node",entityType:"node",entityId:t,payload:{id:t}})}),S(void 0)}async listFields(t){const n=await u.fields.where("parentNodeId").equals(t).toArray();return n.sort((a,o)=>a.cardOrder-o.cardOrder),S(n)}async nextCardOrder(t){const n=await u.fields.where("parentNodeId").equals(t).toArray();if(n.length===0)return S(0);const a=Math.max(...n.map(o=>o.cardOrder));return S(a+1)}async createField(t){const n=M(),a=G(),o=t.cardOrder??(await this.nextCardOrder(t.parentNodeId)).data,l={id:t.id,fieldName:t.fieldName,fieldValue:t.fieldValue,parentNodeId:t.parentNodeId,cardOrder:o,updatedBy:a,updatedAt:n};return await u.transaction("rw",u.fields,u.history,u.syncQueue,async()=>{await u.fields.put(l);const i=await this.nextRev(l.id),v={id:`${l.id}:${i}`,dataFieldId:l.id,parentNodeId:l.parentNodeId,action:"create",property:"fieldValue",prevValue:null,newValue:l.fieldValue,updatedBy:a,updatedAt:n,rev:i};await u.history.put(v),await this.enqueueSyncOperation({operation:"create-field",entityType:"field",entityId:l.id,payload:l})}),S(l)}async updateFieldValue(t,n){const a=await u.fields.get(t);if(!a)throw ee("not-found","Field not found",{retryable:!1});const o=M(),l=G();return await u.transaction("rw",u.fields,u.history,u.syncQueue,async()=>{await u.fields.update(t,{fieldValue:n.fieldValue,updatedAt:o,updatedBy:l});const i=await this.nextRev(t),v={id:`${t}:${i}`,dataFieldId:t,parentNodeId:a.parentNodeId,action:"update",property:"fieldValue",prevValue:a.fieldValue,newValue:n.fieldValue,updatedBy:l,updatedAt:o,rev:i};await u.history.put(v);const r=await u.fields.get(t);r&&await this.enqueueSyncOperation({operation:"update-field",entityType:"field",entityId:t,payload:r})}),S(void 0)}async deleteField(t){const n=await u.fields.get(t);if(!n)return S(void 0);const a=M(),o=G();return await u.transaction("rw",u.fields,u.history,u.syncQueue,async()=>{await u.fields.delete(t);const l=await this.nextRev(t),i={id:`${t}:${l}`,dataFieldId:t,parentNodeId:n.parentNodeId,action:"delete",property:"fieldValue",prevValue:n.fieldValue,newValue:null,updatedBy:o,updatedAt:a,rev:l};await u.history.put(i),await this.enqueueSyncOperation({operation:"delete-field",entityType:"field",entityId:t,payload:{id:t}})}),S(void 0)}async getFieldHistory(t){const n=await u.history.where("dataFieldId").equals(t).toArray();return n.sort((a,o)=>a.rev-o.rev),S(n)}async getSyncQueue(){const t=await u.syncQueue.where("status").equals("pending").toArray();return t.sort((n,a)=>n.timestamp-a.timestamp),t}async markSynced(t){await u.syncQueue.delete(t)}async markFailed(t,n){const a=await u.syncQueue.get(t);a&&await u.syncQueue.update(t,{status:"failed",retryCount:a.retryCount+1,lastError:(n==null?void 0:n.message)||String(n)})}async getLastSyncTimestamp(){const t=await u.syncMetadata.get("lastSyncTimestamp");return(t==null?void 0:t.value)??0}async setLastSyncTimestamp(t){await u.syncMetadata.put({key:"lastSyncTimestamp",value:t})}async applyRemoteUpdate(t,n){t==="node"?await u.nodes.put(n):await u.fields.put(n)}async nextRev(t){const n=await u.history.where("dataFieldId").equals(t).toArray();return n.length===0?0:Math.max(...n.map(o=>o.rev))+1}async enqueueSyncOperation(t){const n={id:z(),operation:t.operation,entityType:t.entityType,entityId:t.entityId,payload:t.payload,timestamp:M(),status:"pending",retryCount:0};await u.syncQueue.put(n)}}const oe=new Qe,Ke=He(oe),ze=Ye(oe);function O(e){return e.data}function He(e){return{getRootNodes:async()=>O(await e.listRootNodes()),getNodeById:async t=>O(await e.getNode(t)),getNodeWithChildren:async t=>{const[n,a]=await Promise.all([e.getNode(t),e.listChildren(t)]);return{node:O(n),children:O(a)}},getChildren:async t=>O(await e.listChildren(t)),createWithFields:async t=>{await e.createNode({id:t.id,parentId:t.parentId,nodeName:t.nodeName,nodeSubtitle:t.nodeSubtitle}),await Promise.all(t.defaults.map(n=>e.createField({id:z(),parentNodeId:t.id,fieldName:n.fieldName,fieldValue:n.fieldValue})))},createEmptyNode:async(t,n)=>O(await e.createNode({id:t,parentId:n,nodeName:"",nodeSubtitle:""})),updateNode:async(t,n)=>{await e.updateNode(t,n)}}}function Ye(e){return{getFieldsForNode:async t=>O(await e.listFields(t)),nextCardOrder:async t=>O(await e.nextCardOrder(t)),addField:async(t,n,a,o)=>O(await e.createField({id:z(),parentNodeId:t,fieldName:n,fieldValue:a,cardOrder:o})),updateFieldValue:async(t,n)=>{await e.updateFieldValue(t,{fieldValue:n})},deleteField:async t=>{await e.deleteField(t)},getFieldHistory:async t=>O(await e.getFieldHistory(t))}}let Xe=Ke,Ze=ze;function H(){return Xe}function B(){return Ze}const Je=280,je=6,et=(e,t)=>{const[n,a,o,l,i]=c(),v=Date.now(),r=v-n.value<=i,f=Math.abs(e-a.value),g=Math.abs(t-o.value),$=f<=l&&g<=l,I=r&&$;return n.value=v,a.value=e,o.value=t,I};function tt(e={}){const t=e.thresholdMs??Je,n=e.slopPx??je,a=_(0),o=_(0),l=_(0);return{checkDoubleTap$:d(et,"s_Ex0CzuR1b0c",[a,o,l,n,t])}}const P={getTreeNodeState:(e,t,n)=>{var a;return((a=e.underConstruction)==null?void 0:a.id)===t?"UNDER_CONSTRUCTION":e.view.state==="ROOT"?"ROOT":e.view.nodeId===t?"PARENT":"CHILD"},getDisplayNodeState:(e,t)=>e.view.state==="ROOT"?"ROOT":e.view.nodeId===t?"PARENT":"CHILD",getDataCardState:(e,t)=>{var n;return((n=e.underConstruction)==null?void 0:n.id)===t?"UNDER_CONSTRUCTION":e.ui.expandedCards.has(t)?"EXPANDED":"COLLAPSED"},getDataFieldState:(e,t)=>e.editingFieldId===t?"EDITING":"DISPLAY",getDataFieldDetailsState:(e,t)=>e.ui.expandedFieldDetails.has(t)?"EXPANDED":"COLLAPSED",isRootView:e=>e.view.state==="ROOT",getCurrentNodeId:e=>e.view.state==="BRANCH"?e.view.nodeId:null,isUnderConstruction:(e,t)=>{var n;return((n=e.underConstruction)==null?void 0:n.id)===t}},nt=({track:e,cleanup:t})=>{const[n,a,o,l]=c(),v=e(()=>n.editingFieldId)===l.fieldId;o.value!==null&&(clearTimeout(o.value),o.value=null),v&&(o.value=window.setTimeout(()=>{if(n.editingFieldId===l.fieldId&&a.value){const r=a.value,f=r.value.length;r.focus(),r.setSelectionRange(f,f)}o.value=null},10)),t(()=>{o.value!==null&&(clearTimeout(o.value),o.value=null)})},at=e=>{const[t,n,a,o,l,i]=c();if(t.editingFieldId!==o.fieldId)return;const v=l.value,r=e.target;v&&r&&!v.contains(r)&&(i(),a.value=n.value)},ot=()=>{const[e,t,n,a,o,l]=c();e.editingFieldId!==a.fieldId&&(l(a.fieldId),n.value=t.value,o.value=null)},lt=async()=>{const[e,t,n,a,o]=c();if(e.editingFieldId!==a.fieldId)return;const l=n.value.trim()===""?null:n.value;await B().updateFieldValue(a.fieldId,l),t.value=l??"",o(),a.onUpdated$&&await a.onUpdated$()},dt=()=>{const[e,t,n,a,o]=c();e.editingFieldId===a.fieldId&&(o(),n.value=t.value)},it=e=>{const[t]=c();t.value=e},st=()=>{const[e,t,n,a,o,l]=c();Date.now()<l.value||e.editingFieldId===a.fieldId&&(o(),n.value=t.value)},rt=e=>{const[t,n]=c();e.key==="Enter"?(e.preventDefault(),n()):e.key==="Escape"&&(e.preventDefault(),t())},ct=async e=>{const[t,n,a,o,l]=c();if(t.editingFieldId!==a.fieldId)return;const i=e.clientX??0,v=e.clientY??0;l.value=Date.now()+220,await n(i,v)&&await o()},ut=async e=>{const[t,n,a,o]=c();if(t.editingFieldId===o.fieldId)return;const l=e.clientX??0,i=e.clientY??0;await a(l,i)&&await n()},pt=e=>{const[t,n,a]=c();t.editingFieldId!==a.fieldId&&(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),n())},vt=e=>{const[t]=c();t.value=e},ft=()=>{const[e]=c();e.value=null},_t=async e=>{const[t,n,a]=c();await B().updateFieldValue(n.fieldId,e),t.value=e??"",a.value=null,n.onUpdated$&&await n.onUpdated$()};function yt(e){const t=x(),{startFieldEdit$:n,stopFieldEdit$:a}=U(),l=P.getDataFieldState(t,e.fieldId)==="EDITING",i=_(),v=_(),r=_(e.initialValue??""),f=_(""),g=_(null),$=_(0),I=_(null),{checkDoubleTap$:m}=tt();W(E("s_Tjhab5vyHfo",[r,e])),K(d(nt,"s_RbAuVMmGAmw",[t,v,I,e])),he("pointerdown",d(at,"s_StU06vsCz00",[t,r,f,e,i,a]));const k=d(ot,"s_0HO9EPvGwSc",[t,r,f,e,g,n]),T=d(lt,"s_TpCFgZeU6Vk",[t,r,f,e,a]),b=d(dt,"s_dsRT43um7vE",[t,r,f,e,a]),Y=d(it,"s_43FZb0QGfSU",[f]),N=d(st,"s_WWaKkyE000c",[t,r,f,e,a,$]),re=d(rt,"s_8yy0Fab0FzY",[b,T]),ce=d(ct,"s_dSOqRahu9fY",[t,m,e,T,$]),ue=d(ut,"s_DkvtW0NQyBE",[t,k,m,e]),pe=d(pt,"s_cmRnDo37yA8",[t,k,e]),ve=d(vt,"s_edkN78Zq06w",[g]),fe=d(ft,"s_Ax8A0n67Fek",[g]),_e=d(_t,"s_85DxwQYAcGo",[r,e,g]),Z=g.value!==null?g.value:r.value,ye=!!Z,ge=g.value!==null;return{isEditing:l,displayValue:Z,isPreviewActive:ge,hasValue:ye,editValue:f,editInputRef:v,rootRef:i,beginEdit$:k,save$:T,cancel$:b,valuePointerDown$:ue,valueKeyDown$:pe,inputPointerDown$:ce,inputBlur$:N,inputKeyDown$:re,inputChange$:Y,setPreview$:ve,revert$:_e,clearPreview$:fe}}const gt="_historyWrapper_163sz_5",ht="_historyList_163sz_17",mt="_historyRow_163sz_41",wt="_historyRowSelected_163sz_99",Nt="_historyValue_163sz_117",$t="_historyMeta_163sz_131",q={historyWrapper:gt,historyList:ht,historyRow:mt,historyRowSelected:wt,historyValue:Nt,historyMeta:$t},bt=e=>{const[t,n]=c();n.value=e.rev,t.onPreviewChange$(e.newValue)},Ct=e=>{const t=_(null),n=[...e.history].reverse(),a=d(bt,"s_BJVayUaFz28",[e,t]),o=i=>{const v=new Date(i),r=v.getDate().toString().padStart(2,"0"),f=(v.getMonth()+1).toString().padStart(2,"0"),g=v.getFullYear(),$=v.getHours().toString().padStart(2,"0"),I=v.getMinutes().toString().padStart(2,"0");return`${r}/${f}/${g}, ${$}:${I}`},l=e.history.length>0;return s("div",null,{class:[q.historyWrapper,"no-caret"]},e.isOpen&&l&&s("div",null,{class:[q.historyList,"no-caret"],role:"listbox","aria-label":"Field value history"},n.map(i=>s("button",{class:[q.historyRow,t.value===i.rev&&q.historyRowSelected],"aria-selected":t.value===i.rev,onClick$:E("s_MsJX096CMQc",[i,a])},{type:"button",role:"option"},[s("span",null,{class:q.historyValue},i.newValue||s("em",null,null,"Empty",3,"MV_0"),1,null),s("span",null,{class:q.historyMeta},[o(i.updatedAt),"  by ",me(i,"updatedBy")],1,null)],0,i.id)),1,"MV_1"),1,"MV_2")},It=C(d(Ct,"s_JOaqQ6mNgM0")),St="_inlineWrapper_g7gtr_7",Dt="_spacer_g7gtr_19",Vt="_buttonGroup_g7gtr_29",Et="_cancelButton_g7gtr_43",Rt="_revertButton_g7gtr_91",Ft="_metadata_g7gtr_141",Ot="_historyChevron_g7gtr_161",kt="_actionsRow_g7gtr_221",At="_deleteButton_g7gtr_233",Bt="_historyRow_g7gtr_279",R={inlineWrapper:St,spacer:Dt,buttonGroup:Vt,cancelButton:Et,revertButton:Rt,metadata:Ft,historyChevron:Ot,actionsRow:kt,deleteButton:At,historyRow:Bt},Tt=()=>{const[e]=c();e.onDelete$()},Pt=e=>{const[t,n]=c();n.value=e,t.onPreviewChange$(e)},xt=async()=>{const[e,t,n,a]=c();if(a.value!==null){await n.onRevert$(a.value);try{const o=await B().getFieldHistory(n.fieldId);e.value=o}catch(o){console.error("Failed to reload field history:",o)}a.value=null,t.value=!1}},Ut=()=>{const[e,t,n]=c();e.value=!e.value,e.value||(n.value=null,t.onPreviewChange$(null))},Wt=()=>{const[e,t,n]=c();n.value=null,t.onPreviewChange$(null),e.value=!1},Mt=e=>{A();const t=_([]),n=_(!1),a=_(!1),o=_(null);W(E("s_R1kXqMQvJ9E",[t,n,e]));const l=d(Tt,"s_0bgQ1zoSedw",[e]),i=d(Pt,"s_zD3B0y4fHO0",[e,o]),v=d(xt,"s_3k04NU4DZf8",[t,a,e,o]),r=d(Ut,"s_QoNOrZ0E02s",[a,e,o]),f=t.value.length>0?t.value[t.value.length-1]:null,g=f!=null&&f.updatedAt?Ge(f.updatedAt):"",$=(f==null?void 0:f.updatedBy)??"",I=n.value&&g?`${g}  ${$}`:"...",m=t.value.length>0,k=o.value!==null,T=d(Wt,"s_Mi0Kr02WGGA",[a,e,o]);return s("div",null,{class:[R.inlineWrapper,"no-caret"]},[k?s("span",null,{class:R.buttonGroup},[s("button",null,{type:"button",class:R.cancelButton,"aria-label":"Cancel selection",onClick$:T},"CANCEL",3,null),s("button",null,{type:"button",class:R.revertButton,"aria-label":"Revert to selected value",onClick$:v},"REVERT",3,null)],3,"dk_0"):s("span",null,{class:[R.spacer,"no-caret"]},null,3,null),s("span",null,{class:[R.metadata,"no-caret"]},I,1,null),s("button",{disabled:!m,title:m?"View field history":"No history available"},{type:"button",class:R.historyChevron,"aria-expanded":p(b=>b.value,[a],"p0.value"),"aria-label":p(b=>b.value?"Close field history":"Open field history",[a],'p0.value?"Close field history":"Open field history"'),onClick$:r},p(b=>b.value?"▾":"◂",[a],'p0.value?"▾":"◂"'),3,null),a.value&&m&&s("div",null,{class:[R.historyRow,"no-caret"]},h(It,{get fieldId(){return e.fieldId},get history(){return t.value},get isOpen(){return a.value},onToggle$:r,onPreviewChange$:i,[y]:{fieldId:p(b=>b.fieldId,[e],"p0.fieldId"),history:p(b=>b.value,[t],"p0.value"),isOpen:p(b=>b.value,[a],"p0.value"),onToggle$:y,onPreviewChange$:y}},3,"dk_1"),1,"dk_2"),s("div",null,{class:[R.actionsRow,"no-caret"]},s("button",null,{type:"button",class:R.deleteButton,"aria-label":"Delete this field",onClick$:l},"Delete Field",3,null),3,null)],1,"dk_3")},qt=C(d(Mt,"s_cNXlVpCg5og")),Lt="_datafieldWrapper_pusyg_5",Gt="_datafieldWrapperExpanded_pusyg_21",Qt="_datafield_pusyg_5",Kt="_datafieldChevron_pusyg_117",zt="_datafieldLabel_pusyg_163",Ht="_datafieldValue_pusyg_175",Yt="_datafieldValueUnderlined_pusyg_183",Xt="_datafieldValueEditable_pusyg_193",Zt="_datafieldPlaceholder_pusyg_235",Jt="_datafieldValuePreview_pusyg_247",V={datafieldWrapper:Lt,datafieldWrapperExpanded:Gt,datafield:Qt,datafieldChevron:Kt,datafieldLabel:zt,datafieldValue:Ht,datafieldValueUnderlined:Yt,datafieldValueEditable:Xt,datafieldPlaceholder:Zt,datafieldValuePreview:Jt},jt=()=>{const[e,t,n,a]=c(),o=P.getDataFieldDetailsState(e,a.id)==="EXPANDED";t.toggleFieldDetailsExpanded$(a.id),o&&n.clearPreview$()},en=async()=>{const[e]=c();await B().deleteField(e.id),e.onDeleted$&&e.onDeleted$()},tn=e=>{A();const t=x(),n=U(),o=P.getDataFieldDetailsState(t,e.id)==="EXPANDED",l=yt({fieldId:e.id,initialValue:e.fieldValue,onUpdated$:e.onUpdated$}),i=d(jt,"s_wqZYmXF10hc",[t,n,l,e]),v=d(en,"s_ldsGGOBThbg",[e]),r=`field-label-${e.id}`;return s("div",{class:[V.datafieldWrapper,o&&V.datafieldWrapperExpanded,"no-caret"],ref:l.rootRef},null,s("div",null,{class:[V.datafield,"no-caret"]},[s("button",{"aria-expanded":o,"aria-label":o?"Collapse field details":"Expand field details"},{type:"button",class:V.datafieldChevron,onClick$:i},o?"▾":"▸",1,null),s("label",{id:r},{class:V.datafieldLabel},[p(f=>f.fieldName,[e],"p0.fieldName"),":"],3,null),l.isEditing?s("input",{ref:l.editInputRef,class:[V.datafieldValue,l.editValue.value&&V.datafieldValueUnderlined],"aria-labelledby":r,onInput$:E("s_vhiFO47zY4A",[l]),onPointerDown$:l.inputPointerDown$,onBlur$:l.inputBlur$,onKeyDown$:l.inputKeyDown$},{value:p(f=>f.editValue.value,[l],"p0.editValue.value"),autoFocus:!0},null,2,"o6_0"):s("div",{class:[V.datafieldValue,l.hasValue&&V.datafieldValueUnderlined,V.datafieldValueEditable,l.isPreviewActive&&V.datafieldValuePreview,"no-caret"],"aria-labelledby":r,onPointerDown$:l.valuePointerDown$,onKeyDown$:l.valueKeyDown$},{tabIndex:0,role:"button","aria-description":"Press Enter to edit"},l.displayValue||s("span",null,{class:V.datafieldPlaceholder},"Empty",3,"o6_1"),0,null),o&&h(qt,{get fieldId(){return e.id},get fieldName(){return e.fieldName},get currentValue(){return l.displayValue},onDelete$:v,onPreviewChange$:l.setPreview$,onRevert$:l.revert$,[y]:{fieldId:p(f=>f.id,[e],"p0.id"),fieldName:p(f=>f.fieldName,[e],"p0.fieldName"),currentValue:p(f=>f.displayValue,[l],"p0.displayValue"),onDelete$:y}},2,"o6_2")],1,null),1,"o6_3")},nn=C(d(tn,"s_2gBrAJoSz7w")),an="_constructionWrapper_aoisn_51",on="_construction_aoisn_51",ln="_chevronButton_aoisn_83",dn="_chevron_aoisn_83",sn="_chevronOpen_aoisn_141",rn="_comboBoxWrapper_aoisn_159",cn="_inputName_aoisn_169",un="_inputValue_aoisn_207",pn="_dropdown_aoisn_245",vn="_dropdownItem_aoisn_269",fn="_actions_aoisn_315",_n="_actionButton_aoisn_329",yn="_cancelButton_aoisn_367",D={constructionWrapper:an,construction:on,chevronButton:ln,chevron:dn,chevronOpen:sn,comboBoxWrapper:rn,inputName:cn,inputValue:un,dropdown:pn,dropdownItem:vn,actions:fn,actionButton:_n,cancelButton:yn},gn=()=>{const[e,t]=c();t.initialName||setTimeout(()=>{var n;(n=e.value)==null||n.focus()},10)},hn=()=>{const[e,t,n]=c();n.onChange$&&n.onChange$(n.id,e.value,t.value||null)},mn=()=>{const[e,t,n]=c(),a=e.value.trim(),o=t.value.trim()||null;n.onSave$(n.id,a,o)},wn=()=>{const[e]=c();document.activeElement instanceof HTMLElement&&document.activeElement.blur(),e.onCancel$(e.id)},Nn=()=>{const[e,t,n]=c();if(!n.value&&e.value){const a=e.value.getBoundingClientRect();t.value={top:a.bottom+2,left:a.left,width:a.width}}n.value=!n.value},$n=e=>{const[t,n,a,o]=c();t.value=e,n.value=!1,a(),setTimeout(()=>{var l;(l=o.value)==null||l.focus()},10)},bn=e=>{const[t,n]=c();t.value=e.target.value,n()},Cn=e=>{const[t,n]=c();t.value=e.target.value,n()},In=e=>{var i;const[t,n,a,o,l]=c();e.key==="Enter"?(e.preventDefault(),a()):e.key==="Escape"?(e.preventDefault(),n.value?n.value=!1:t()):e.key==="ArrowDown"?(e.preventDefault(),o()):e.key==="Tab"&&!e.shiftKey&&(e.preventDefault(),(i=l.value)==null||i.focus())},Sn=e=>{var o;const[t,n,a]=c();e.key==="Enter"?(e.preventDefault(),a()):e.key==="Escape"?(e.preventDefault(),t()):e.key==="Tab"&&e.shiftKey&&(e.preventDefault(),(o=n.value)==null||o.focus())},Dn=e=>{const[t,n,a]=c();e.key==="Enter"||e.key===" "?(e.preventDefault(),a()):e.key==="Escape"&&(e.preventDefault(),n.value?n.value=!1:t())},Vn=e=>{const t=_(e.initialName??""),n=_(e.initialValue??""),a=_(!1),o=_(),l=_(),i=_(),v=_({top:0,left:0,width:0});K(d(gn,"s_b1r271u70lg",[o,e]));const r=d(hn,"s_5qS05iQ3kzk",[t,n,e]),f=d(mn,"s_VXoapCcVBGQ",[t,n,e]),g=d(wn,"s_pO38pDzpTKY",[e]),$=d(Nn,"s_CPeMh0DlK80",[i,v,a]),I=d($n,"s_JKvEDYW7DNg",[t,a,r,l]),m=d(bn,"s_C64zPMw20r4",[t,r]),k=d(Cn,"s_1yLyyhcqgGY",[n,r]),T=d(In,"s_y0PWFrmLvh4",[g,a,f,$,l]),b=d(Sn,"s_PaMVmYQPeZ4",[g,o,f]),Y=d(Dn,"s_AWjg7A8hpOg",[g,a,$]);return s("div",null,{class:D.constructionWrapper},[s("div",null,{class:D.construction},[s("button",null,{type:"button",class:D.chevronButton,"aria-expanded":p(N=>N.value,[a],"p0.value"),"aria-label":p(N=>N.value?"Close field name picker":"Open field name picker",[a],'p0.value?"Close field name picker":"Open field name picker"'),tabIndex:-1,onClick$:$,onKeyDown$:Y},s("span",{class:[D.chevron,a.value&&D.chevronOpen]},null,null,3,null),1,null),s("div",{ref:i},{class:D.comboBoxWrapper},[s("input",{ref:o},{type:"text",class:D.inputName,value:p(N=>N.value,[t],"p0.value"),placeholder:"Field Name","aria-label":"Field name (press Down Arrow for library)",onInput$:m,onKeyDown$:T,onFocus$:E("s_0IWX0Y3zQpc",[a])},null,3,null),a.value&&s("div",null,{class:D.dropdown,role:"listbox","aria-label":"Prefab field names",style:p(N=>({top:`${N.value.top}px`,left:`${N.value.left}px`,width:`${N.value.width}px`}),[v],"{top:`${p0.value.top}px`,left:`${p0.value.left}px`,width:`${p0.value.width}px`}")},qe.map(N=>s("button",{onClick$:E("s_WB40vqhys98",[N,I])},{type:"button",class:D.dropdownItem,role:"option"},N,0,N)),1,"S1_0")],1,null),s("input",{ref:l},{type:"text",class:D.inputValue,value:p(N=>N.value,[n],"p0.value"),placeholder:"Value (optional)","aria-label":"Field value",onInput$:k,onKeyDown$:b},null,3,null)],1,null),s("div",null,{class:D.actions},[s("button",null,{type:"button",class:[D.actionButton,D.cancelButton],onClick$:g},"Cancel",3,null),s("button",null,{type:"button",class:D.actionButton,onClick$:f},"Save",3,null)],3,null)],1,"S1_1")},En=C(d(Vn,"s_rgskcIH6ZDg")),Rn=()=>{const[e,t,n,a]=c(),o=a.nodeId,l=a.enabled;(t.value!==o||e.value!==l)&&(t.value=o,e.value=l,n.value++)},Fn=async()=>{const[e,t,n,a]=c();e.value&&(a.value=!0,n.value=await B().getFieldsForNode(t.value),a.value=!1)};function On(e){const t=_(null),n=_(!1),a=_(e.nodeId),o=_(e.enabled),l=_(0);return K(d(Rn,"s_4i3R51gQIV8",[o,a,l,e])),W(E("s_Ch3EXBvP4ag",[o,a,t,n,l])),{fields:t,isLoading:n,reload$:d(Fn,"s_7gfJWzE1Bug",[o,a,t,n])}}const te=e=>`pendingFields:${e}`,kn=(e,t)=>{try{t.length===0?localStorage.removeItem(te(e)):localStorage.setItem(te(e),JSON.stringify(t))}catch{}},An=({track:e})=>{const[t,n]=c(),a=e(()=>t.value);typeof localStorage<"u"&&kn(n.nodeId,a)},Bn=async()=>{const[e,t]=c(),n=t.maxPersistedCardOrder$.value,a=e.value.length>0?Math.max(...e.value.map(i=>i.cardOrder)):-1,o=Math.max(n,a)+1,l={id:z(),fieldName:"",fieldValue:null,cardOrder:o};e.value=[...e.value,l]},Tn=async(e,t,n)=>{const[a,o]=c(),l=t.trim();if(!l){a.value=a.value.filter(r=>r.id!==e);return}const i=a.value.find(r=>r.id===e),v=i==null?void 0:i.cardOrder;await B().addField(o.nodeId,l,n,v),a.value=a.value.filter(r=>r.id!==e),await o.onSaved$()},Pn=e=>{const[t]=c();t.value=t.value.filter(n=>n.id!==e)},xn=(e,t,n)=>{const[a]=c();a.value=a.value.map(o=>o.id===e?{...o,fieldName:t,fieldValue:n}:o)},Un=async()=>{const[e,t]=c(),n=e.value.filter(o=>o.fieldName.trim());if(n.length===0)return 0;const a=B();return await Promise.all(n.map(o=>a.addField(t.nodeId,o.fieldName.trim(),o.fieldValue,o.cardOrder))),e.value=[],await t.onSaved$(),n.length};function Wn(e){const t=_([]),n=_(!1);return W(E("s_qU68K91Z7fs",[t,n,e])),K(d(An,"s_7EzmTvHmSgg",[t,e])),{forms:t,add$:d(Bn,"s_Biym0x2w2Hg",[t,e]),save$:d(Tn,"s_w000e3KQtXY",[t,e]),cancel$:d(Pn,"s_tq0phclloKM",[t]),change$:d(xn,"s_IrI7Myrn2Ko",[t]),saveAllPending$:d(Un,"s_CEglqaDCkrM",[t,e])}}const Mn="_fieldList_5uih9_5",qn="_addButton_5uih9_17",ne={fieldList:Mn,addButton:qn},le=30,Ln=()=>{const[e]=c();return!e.fields.value||e.fields.value.length===0?-1:Math.max(...e.fields.value.map(t=>t.cardOrder))},Gn=()=>{const[e,t]=c(),n=[];if(t.fields.value)for(const a of t.fields.value)n.push({type:"persisted",field:a});for(const a of e.forms.value)n.push({type:"pending",form:a});return n.sort((a,o)=>{const l=a.type==="persisted"?a.field.cardOrder:a.form.cardOrder,i=o.type==="persisted"?o.field.cardOrder:o.form.cardOrder;return l-i}),n},Qn=()=>{const[e]=c();e.reload$()},Kn=()=>{const[e]=c();e.forms.value.length<le&&e.add$()},zn=e=>{const t=On({nodeId:e.nodeId,enabled:!0}),n=j(d(Ln,"s_09wqlr4vzW0",[t])),a=Wn({nodeId:e.nodeId,onSaved$:t.reload$,initialFieldNames:e.initialFieldNames,maxPersistedCardOrder$:n});W(E("s_YFcoGOqtLXk",[a,e]));const o=j(d(Gn,"s_vrtZqVijSkE",[a,t])),l=d(Qn,"s_XhGlu5hwbws",[t]),i=d(Kn,"s_WITd5JAXm44",[a]),v=a.forms.value.length<le;return s("div",null,{class:ne.fieldList},[o.value.map(r=>(A(),r.type==="persisted"?h(nn,{get id(){return r.field.id},get fieldName(){return r.field.fieldName},get fieldValue(){return r.field.fieldValue},onDeleted$:l,[y]:{id:F(r.field,"id"),fieldName:F(r.field,"fieldName"),fieldValue:F(r.field,"fieldValue"),onDeleted$:y}},3,r.field.id):h(En,{get id(){return r.form.id},get initialName(){return r.form.fieldName},get initialValue(){return r.form.fieldValue},onSave$:a.save$,onCancel$:a.cancel$,onChange$:a.change$,[y]:{id:F(r.form,"id"),initialName:F(r.form,"fieldName"),initialValue:F(r.form,"fieldValue")}},2,r.form.id))),s("button",{disabled:!v,"aria-label":v?"Add new field":"Maximum fields reached"},{type:"button",class:ne.addButton,onClick$:i},"+ Add Field",3,null)],1,"Bt_0")},de=C(d(zn,"s_2RnEZFWrgIk")),Hn="_upButton_1crd4_5",Yn={upButton:Hn},Xn=e=>s("button",null,{class:Yn.upButton,title:p(t=>t.parentId?"Go to parent":"Go to root",[e],'p0.parentId?"Go to parent":"Go to root"'),"aria-label":p(t=>t.parentId?"Go to parent":"Go to root",[e],'p0.parentId?"Go to parent":"Go to root"'),onClick$:E("s_zrBmdNlvcAw",[e])},"↑",3,"BX_0"),Zn=C(d(Xn,"s_zKD01KoPOyE")),Jn=e=>{const[t,n]=c();e==null||e.stopPropagation(),t.toggleCardExpanded$(n.id)},jn=e=>{const[t]=c();t.onNodeClick$&&(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t.onNodeClick$())},ea=e=>{const[t]=c();(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),e.stopPropagation(),t())},ta=e=>{A();const t=x(),n=U(),o=P.getDataCardState(t,e.id)==="EXPANDED",l=d(Jn,"s_fJ0tmVx2bMU",[n,e]),i=d(jn,"s_vomB1hyhwlk",[e]),v=d(ea,"s_Utk55o3tQGk",[l]),r=`node-title-${e.id}`,f=!!e.onNodeClick$,g=e.nodeState==="PARENT",I=e.nodeState==="CHILD"?"18px":"50px";return s("div",{style:{"--datacard-indent":I}},{class:w.nodeWrapper},[s("article",{class:[w.node,o&&w.nodeExpanded,g&&w.nodeParent],"aria-labelledby":r},{"data-node-id":p(m=>m.id,[e],"p0.id")},s("div",{class:[w.nodeBody,f&&w.nodeBodyClickable,f&&"no-caret"],role:f?"button":void 0,tabIndex:f?0:void 0,"aria-label":f?`Open ${e.nodeName||"node"}`:void 0,onClick$:e.onNodeClick$,onKeyDown$:i},null,[g&&e.onNavigateUp$&&s("div",null,{class:w.upButtonWrapper},h(Zn,{get parentId(){return e.parentId??null},onNavigate$:e.onNavigateUp$,[y]:{parentId:p(m=>m.parentId??null,[e],"p0.parentId??null")}},2,"vG_0"),1,"vG_1"),s("div",null,null,[h(Oe,{get nodeName(){return e.nodeName},id:r,[y]:{nodeName:p(m=>m.nodeName,[e],"p0.nodeName")}},3,"vG_2"),h(Ae,{get nodeSubtitle(){return e.nodeSubtitle},[y]:{nodeSubtitle:p(m=>m.nodeSubtitle,[e],"p0.nodeSubtitle")}},3,"vG_3")],1,null),s("button",{"aria-expanded":o,"aria-label":o?"Collapse details":"Expand details"},{type:"button",class:w.nodeChevron,onClick$:l,onKeyDown$:v},o?"▾":"◂",1,null)],0,null),1,null),h(ae,{isOpen:o,get nodeId(){return e.id},children:h(de,{get nodeId(){return e.id},[y]:{nodeId:p(m=>m.id,[e],"p0.id")}},3,"vG_4"),[y]:{nodeId:p(m=>m.id,[e],"p0.id")}},1,"vG_5")],1,"vG_6")},na=C(d(ta,"s_06szQ6qXZeE")),aa=async()=>{var v,r,f,g,$,I;const[e,t,n,a]=c();e.value&&await e.value.saveAllPending$(),console.log("[handleCreate$] nameInputRef.value:",t.value),console.log("[handleCreate$] subtitleInputRef.value:",a.value),console.log("[handleCreate$] nameInputRef placeholder:",(v=t.value)==null?void 0:v.placeholder),console.log("[handleCreate$] subtitleInputRef placeholder:",(r=a.value)==null?void 0:r.placeholder),console.log("[handleCreate$] nameInputRef.value.value:",(f=t.value)==null?void 0:f.value),console.log("[handleCreate$] subtitleInputRef.value.value:",(g=a.value)==null?void 0:g.value);const o=document.querySelectorAll("input");console.log("[handleCreate$] All inputs on page:",o.length),o.forEach((m,k)=>{console.log(`[handleCreate$] Input ${k}: placeholder="${m.placeholder}", value="${m.value}"`)});const l=(($=t.value)==null?void 0:$.value)||"",i=((I=a.value)==null?void 0:I.value)||"";console.log("[handleCreate$] Final values - nodeName:",JSON.stringify(l),"nodeSubtitle:",JSON.stringify(i)),await n.onCreate$({nodeName:l,nodeSubtitle:i,fields:[]})},oa=e=>{const[t,n]=c();e.key==="Enter"?(e.preventDefault(),t()):e.key==="Escape"&&(e.preventDefault(),n.onCancel$())},la=e=>{const t=_(),n=_(),a=_(null);W(E("s_82IaKsCDbGY",[t]));const o=d(aa,"s_60fRKu4o7GU",[a,t,e,n]),l=d(oa,"s_ZHVlk1DFSAo",[o,e]),i=`node-title-${e.id}`,v=e.isChildConstruction?"18px":"50px";return s("div",{style:{"--datacard-indent":v}},{class:w.nodeWrapper},[s("article",{"aria-labelledby":i},{class:[w.node,w.nodeExpanded]},s("div",null,{class:w.nodeBody},[s("div",null,null,[s("input",{ref:t,id:i},{class:w.nodeTitle,placeholder:"Name","aria-label":"Node name",onKeyDown$:l},null,3,null),s("input",{ref:n},{class:w.nodeSubtitle,placeholder:"Subtitle / Location / Short description","aria-label":"Node subtitle",onKeyDown$:l},null,3,null)],1,null),s("button",null,{type:"button",class:w.nodeChevron,"aria-expanded":!0,"aria-label":"Collapse details",disabled:!0},"▾",3,null)],1,null),1,null),h(ae,{get nodeId(){return e.id},isOpen:!0,children:[h(de,{get nodeId(){return e.id},initialFieldNames:Le,handleRef:a,[y]:{nodeId:p(r=>r.id,[e],"p0.id"),initialFieldNames:y,handleRef:y}},3,"qo_0"),s("div",{"q:slot":"actions"},{class:w.constructionActions},[s("button",{onClick$:e.onCancel$},{type:"button"},"Cancel",2,null),s("button",null,{type:"button",onClick$:o},"Create",3,null)],1,null)],[y]:{nodeId:p(r=>r.id,[e],"p0.id"),isOpen:y}},1,"qo_1")],1,"qo_2")},da=C(d(la,"s_0HiZh00BXTo"));function ia(e){return e.nodeState==="UNDER_CONSTRUCTION"}const sa=e=>(A(),ia(e)?h(da,{get id(){return e.id},get initialName(){return e.nodeName},get initialSubtitle(){return e.nodeSubtitle},get isChildConstruction(){return e.isChildConstruction},onCancel$:e.onCancel$,onCreate$:e.onCreate$,[y]:{id:p(t=>t.id,[e],"p0.id"),initialName:p(t=>t.nodeName,[e],"p0.nodeName"),initialSubtitle:p(t=>t.nodeSubtitle,[e],"p0.nodeSubtitle"),isChildConstruction:p(t=>t.isChildConstruction,[e],"p0.isChildConstruction")}},2,"gq_0"):h(na,{get id(){return e.id},get nodeName(){return e.nodeName},get nodeSubtitle(){return e.nodeSubtitle},get nodeState(){return e.nodeState},get parentId(){return e.parentId},onNodeClick$:e.onNodeClick$,onNavigateUp$:e.onNavigateUp$,[y]:{id:p(t=>t.id,[e],"p0.id"),nodeName:p(t=>t.nodeName,[e],"p0.nodeName"),nodeSubtitle:p(t=>t.nodeSubtitle,[e],"p0.nodeSubtitle"),nodeState:p(t=>t.nodeState,[e],"p0.nodeState"),parentId:p(t=>t.parentId,[e],"p0.parentId")}},2,"gq_1")),Q=C(d(sa,"s_gegngB44RHE")),ra="_createNode_194o9_5",ca="_createNodeChild_194o9_49",X={createNode:ra,createNodeChild:ca},ua=async()=>{const[e]=c();e.onClick$&&await e.onClick$()},pa=e=>{const t=d(ua,"s_m1x9adscB00",[e]);return e.variant==="root"?s("button",null,{type:"button",class:[X.createNode,"no-caret"],"aria-label":"Create New Asset",onClick$:t},"Create New Asset",3,"ad_0"):e.variant==="child"?s("button",null,{type:"button",class:[X.createNode,X.createNodeChild,"no-caret"],"aria-label":"Add Sub-Asset",onClick$:t},"+ Add Sub-Asset",3,"ad_1"):null},ie=C(d(pa,"s_0wYRrfEmCIE")),va=async()=>{const[e,t]=c(),n=z();await H().createEmptyNode(n,e.parentId),await t({id:n,parentId:e.parentId,nodeName:"",nodeSubtitle:"",defaultFields:[]})},fa=async()=>{const[e]=c();await e()},_a=async e=>{const[t,n,a]=c();console.log("[complete$] Received payload:",JSON.stringify(e));const o=t.underConstruction;if(console.log("[complete$] ucData:",o),!o){console.log("[complete$] No ucData, returning early!");return}if(console.log("[complete$] Updating node",o.id,"with:",{nodeName:e.nodeName||"Untitled",nodeSubtitle:e.nodeSubtitle||""}),await H().updateNode(o.id,{nodeName:e.nodeName||"Untitled",nodeSubtitle:e.nodeSubtitle||""}),console.log("[complete$] Node updated, calling completeConstruction$"),e.fields.length>0){const l=B();await Promise.all(e.fields.map(i=>l.addField(o.id,i.fieldName,i.fieldValue)))}await n(),console.log("[complete$] completeConstruction$ done, calling onCreated$"),await a.onCreated$(),console.log("[complete$] onCreated$ done, complete$ finished")};function se(e){const t=x(),{startConstruction$:n,cancelConstruction$:a,completeConstruction$:o}=U(),l=d(va,"s_n6hsWUuIj1Y",[e,n]),i=d(fa,"s_cbiq6e5O6us",[a]),v=d(_a,"s_v6yCRyJjgcY",[t,o,e]);return{ucNode:t.underConstruction,start$:l,cancel$:i,complete$:v}}const ya=async()=>{const[e,t]=c();console.log("[useRootViewData] load$ called"),e.value=!0;try{const n=await H().getRootNodes();console.log("[useRootViewData] Fetched nodes FULL:",JSON.stringify(n.map(a=>({id:a.id.substring(0,8),nodeName:a.nodeName,nodeSubtitle:a.nodeSubtitle,updatedAt:a.updatedAt})),null,2)),t.value=n,console.log("[useRootViewData] nodes.value set to",t.value.length,"nodes")}finally{e.value=!1}};function ga(){const e=_([]),t=_(!1),n=d(ya,"s_UIfphfAKvzM",[t,e]);return W(E("s_j2W4Hu2S1VQ",[n])),{nodes:e,isLoading:t,reload$:n}}const ha=()=>{const[e,t]=c();return e.navigateToNode$(t.id)},ma=()=>{A();const e=x(),t=U(),n=ga(),a=se({parentId:null,onCreated$:n.reload$}),o=a.ucNode?n.nodes.value.filter(l=>l.id!==a.ucNode.id):n.nodes.value;return s("main",null,{class:"view-root"},[o.map(l=>h(Q,{get id(){return l.id},get nodeName(){return l.nodeName},nodeSubtitle:l.nodeSubtitle??"",nodeState:P.getDisplayNodeState(e,l.id),onNodeClick$:d(ha,"s_FBTGThmmG98",[t,l]),[y]:{id:F(l,"id"),nodeName:F(l,"nodeName")}},3,l.id)),a.ucNode?h(Q,{get id(){return a.ucNode.id},get nodeName(){return a.ucNode.nodeName},get nodeSubtitle(){return a.ucNode.nodeSubtitle},nodeState:"UNDER_CONSTRUCTION",onCancel$:a.cancel$,onCreate$:a.complete$,[y]:{id:p(l=>l.ucNode.id,[a],"p0.ucNode.id"),nodeName:p(l=>l.ucNode.nodeName,[a],"p0.ucNode.nodeName"),nodeSubtitle:p(l=>l.ucNode.nodeSubtitle,[a],"p0.ucNode.nodeSubtitle"),nodeState:y}},2,a.ucNode.id):null,h(ie,{variant:"root",onClick$:a.start$,[y]:{variant:y}},2,"7G_0")],1,"7G_1")},wa=C(d(ma,"s_hNvYX6tEL2I")),Na=async e=>{const[t,n,a,o,l]=c();if(e){t.underConstruction&&n(),o.value=!0;try{const i=await H().getNodeWithChildren(e);l.value=i.node,a.value=i.children}finally{o.value=!1}}};function $a(){const e=_(null),t=_([]),n=_(!1),a=x(),{cancelConstruction$:o}=U(),l=d(Na,"s_cbTnqvcou0A",[a,o,t,n,e]);return{parentNode:e,children:t,isLoading:n,load$:l,reload$:l}}const ba=async({track:e})=>{const[t,n]=c(),a=e(()=>n.parentId);a&&await t.load$(a)},Ca=async()=>{const[e,t]=c();await e.reload$(t.parentId)},Ia=()=>{const[e,t]=c();return e.navigateToNode$(t.id)},Sa=e=>{A();const t=U(),n=$a();K(d(ba,"s_yRk2iqAjgFI",[n,e]));const a=se({parentId:e.parentId,onCreated$:d(Ca,"s_02bEtWr042Y",[n,e])});return n.isLoading.value||!n.parentNode.value?s("main",null,{class:"view-branch"},"Loading...",3,"RT_0"):s("main",null,{class:"view-branch"},[s("div",null,{class:"branch-parent-row"},s("div",null,{class:"branch-parent-node"},h(Q,{get id(){return n.parentNode.value.id},get nodeName(){return n.parentNode.value.nodeName},get nodeSubtitle(){return n.parentNode.value.nodeSubtitle??""},nodeState:"PARENT",get parentId(){return n.parentNode.value.parentId},onNavigateUp$:t.navigateUp$,[y]:{id:p(o=>o.parentNode.value.id,[n],"p0.parentNode.value.id"),nodeName:p(o=>o.parentNode.value.nodeName,[n],"p0.parentNode.value.nodeName"),nodeSubtitle:p(o=>o.parentNode.value.nodeSubtitle??"",[n],'p0.parentNode.value.nodeSubtitle??""'),nodeState:y,parentId:p(o=>o.parentNode.value.parentId,[n],"p0.parentNode.value.parentId")}},2,n.parentNode.value.id),1,null),1,null),s("div",null,{class:"branch-children"},[n.children.value.filter(o=>!a.ucNode||o.id!==a.ucNode.id).map(o=>h(Q,{get id(){return o.id},get nodeName(){return o.nodeName},nodeSubtitle:o.nodeSubtitle??"",nodeState:"CHILD",onNodeClick$:d(Ia,"s_ubVdAKhHRM8",[t,o]),[y]:{id:F(o,"id"),nodeName:F(o,"nodeName"),nodeState:y}},3,o.id)),a.ucNode?s("div",null,{class:"branch-child-row"},h(Q,{get id(){return a.ucNode.id},get nodeName(){return a.ucNode.nodeName},get nodeSubtitle(){return a.ucNode.nodeSubtitle},nodeState:"UNDER_CONSTRUCTION",isChildConstruction:!0,onCancel$:a.cancel$,onCreate$:a.complete$,[y]:{id:p(o=>o.ucNode.id,[a],"p0.ucNode.id"),nodeName:p(o=>o.ucNode.nodeName,[a],"p0.ucNode.nodeName"),nodeSubtitle:p(o=>o.ucNode.nodeSubtitle,[a],"p0.ucNode.nodeSubtitle"),nodeState:y,isChildConstruction:y}},2,a.ucNode.id),1,"RT_1"):null,h(ie,{variant:"child",onClick$:a.start$,[y]:{variant:y}},2,"RT_2")],1,null)],1,"RT_3")},Da=C(d(Sa,"s_gIJMeo2tapw")),Va=()=>{A();const e=x(),t=P.isRootView(e),n=P.getCurrentNodeId(e);return t?h(wa,null,3,"sJ_0"):h(Da,{parentId:n},3,"sJ_1")},Ea=C(d(Va,"s_yh0RYmyrFWk")),Ra=Object.freeze(Object.defineProperty({__proto__:null,default:Ea},Symbol.toStringTag,{value:"Module"})),Fa=[],Oa=[["/",[()=>Ra],"/",[]]],ka=[],Aa=!0,Ba="/",Ta=!0,Ua={routes:Oa,serverPlugins:Fa,menus:ka,trailingSlash:Aa,basePathname:Ba,cacheModules:Ta};export{Ba as basePathname,Ta as cacheModules,Ua as default,ka as menus,Oa as routes,Fa as serverPlugins,Aa as trailingSlash};
